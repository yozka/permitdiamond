#include "pdCommand_reinitialize.h"

#include <ESP8266WiFi.h>

///--------------------------------------------------------------------------------------
using namespace Terminal;
///--------------------------------------------------------------------------------------





 ///=====================================================================================
///
/// Constructor
/// 
/// 
///--------------------------------------------------------------------------------------
ACMD_reinitialize :: ACMD_reinitialize(Options::AOptions *options)
	:
		mOptions(options)
{

}
///--------------------------------------------------------------------------------------





 ///=====================================================================================
///
/// Destructor
/// 
/// 
///--------------------------------------------------------------------------------------
ACMD_reinitialize :: ~ACMD_reinitialize()
{

}
///--------------------------------------------------------------------------------------








 ///=====================================================================================
///
/// Выполнение команды
/// 
/// 
///--------------------------------------------------------------------------------------
void ACMD_reinitialize :: execute(Stream *stream, const String &param)
{
	if (mOptions == nullptr || stream == nullptr)
	{
		return;
	}
	stream->println(FPSTR("Сброс установок"));
	mOptions->reinitialize();
	stream->print(FPSTR("Перезагрузка устройства"));
	for (int i = 0; i < 5; i++)
	{
		delay(500);
		stream->print(FPSTR("."));
	}
	ESP.wdtDisable();
	ESP.restart();
	stream->println();
}
///--------------------------------------------------------------------------------------



